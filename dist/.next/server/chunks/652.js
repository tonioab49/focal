exports.id=652,exports.ids=[652],exports.modules={4226:(e,t,s)=>{let a={"0b32d0e7a9e913867bfb2724e5c71bc874ca9624":()=>Promise.resolve().then(s.bind(s,9053)).then(e=>e.saveTask),"29d9cd11d097fcb6690a26ef774aeeee260b389b":()=>Promise.resolve().then(s.bind(s,9053)).then(e=>e.setSelectedRepo),"4810e0847edab22d875d1f15f89918103c558ebd":()=>Promise.resolve().then(s.bind(s,9053)).then(e=>e.commitChanges),"48e24bf6b7790941829c1b47555db59c45439f76":()=>Promise.resolve().then(s.bind(s,9053)).then(e=>e.getGitStatus),"5171b9bc6fa8d6fb730de54219624f90f34cbafd":()=>Promise.resolve().then(s.bind(s,9053)).then(e=>e.createTask),"5896e2c5181e1accf5bdf86f55c5717bc2bfa048":()=>Promise.resolve().then(s.bind(s,9053)).then(e=>e.getUncommittedFiles),ac8031647eec6a4700a6a90d39c2af1c1d5bd267:()=>Promise.resolve().then(s.bind(s,9053)).then(e=>e.getRepoList),bfa1de4d25904e288eea8780fb8c48c13f8304d2:()=>Promise.resolve().then(s.bind(s,9053)).then(e=>e.getSelectedRepo),d36e843f1a3e9ed7e591d8cb5f8779c3f4ad0876:()=>Promise.resolve().then(s.bind(s,9053)).then(e=>e.saveDoc),f53de7a8283b631e23b5e166f5d38eeac215e2cd:()=>Promise.resolve().then(s.bind(s,9053)).then(e=>e.createDoc)};async function r(e,...t){return(await a[e]()).apply(null,t)}e.exports={"0b32d0e7a9e913867bfb2724e5c71bc874ca9624":r.bind(null,"0b32d0e7a9e913867bfb2724e5c71bc874ca9624"),"29d9cd11d097fcb6690a26ef774aeeee260b389b":r.bind(null,"29d9cd11d097fcb6690a26ef774aeeee260b389b"),"4810e0847edab22d875d1f15f89918103c558ebd":r.bind(null,"4810e0847edab22d875d1f15f89918103c558ebd"),"48e24bf6b7790941829c1b47555db59c45439f76":r.bind(null,"48e24bf6b7790941829c1b47555db59c45439f76"),"5171b9bc6fa8d6fb730de54219624f90f34cbafd":r.bind(null,"5171b9bc6fa8d6fb730de54219624f90f34cbafd"),"5896e2c5181e1accf5bdf86f55c5717bc2bfa048":r.bind(null,"5896e2c5181e1accf5bdf86f55c5717bc2bfa048"),ac8031647eec6a4700a6a90d39c2af1c1d5bd267:r.bind(null,"ac8031647eec6a4700a6a90d39c2af1c1d5bd267"),bfa1de4d25904e288eea8780fb8c48c13f8304d2:r.bind(null,"bfa1de4d25904e288eea8780fb8c48c13f8304d2"),d36e843f1a3e9ed7e591d8cb5f8779c3f4ad0876:r.bind(null,"d36e843f1a3e9ed7e591d8cb5f8779c3f4ad0876"),f53de7a8283b631e23b5e166f5d38eeac215e2cd:r.bind(null,"f53de7a8283b631e23b5e166f5d38eeac215e2cd")}},8586:(e,t,s)=>{Promise.resolve().then(s.t.bind(s,2994,23)),Promise.resolve().then(s.t.bind(s,6114,23)),Promise.resolve().then(s.t.bind(s,9727,23)),Promise.resolve().then(s.t.bind(s,9671,23)),Promise.resolve().then(s.t.bind(s,1868,23)),Promise.resolve().then(s.t.bind(s,4759,23))},2988:(e,t,s)=>{Promise.resolve().then(s.bind(s,2456)),Promise.resolve().then(s.bind(s,744))},8033:(e,t,s)=>{"use strict";s.d(t,{F9:()=>i,MF:()=>c,VA:()=>r,dj:()=>n,do:()=>o,vr:()=>l}),s(5424);var a=s(6242),r=(0,a.$)("4810e0847edab22d875d1f15f89918103c558ebd"),n=(0,a.$)("29d9cd11d097fcb6690a26ef774aeeee260b389b");(0,a.$)("bfa1de4d25904e288eea8780fb8c48c13f8304d2"),(0,a.$)("ac8031647eec6a4700a6a90d39c2af1c1d5bd267");var i=(0,a.$)("0b32d0e7a9e913867bfb2724e5c71bc874ca9624"),c=(0,a.$)("d36e843f1a3e9ed7e591d8cb5f8779c3f4ad0876");(0,a.$)("48e24bf6b7790941829c1b47555db59c45439f76"),(0,a.$)("5896e2c5181e1accf5bdf86f55c5717bc2bfa048");var l=(0,a.$)("5171b9bc6fa8d6fb730de54219624f90f34cbafd"),o=(0,a.$)("f53de7a8283b631e23b5e166f5d38eeac215e2cd")},2456:(e,t,s)=>{"use strict";s.d(t,{AppShell:()=>b});var a=s(326),r=s(7577),n=s(5047),i=s(434),c=s(962),l=s(8033),o=s(8176);function d({gitStatus:e,selectedRepo:t}){let s=(0,n.useRouter)(),[i,d]=(0,r.useState)(!1),[f,u]=(0,r.useTransition)(),[m,h]=(0,r.useState)(null),b=e.files.length,x=b>0,p=(0,r.useCallback)(()=>{f||e.localMode||u(async()=>{h((await (0,l.VA)(t)).message),s.refresh()})},[f,e.localMode,t,s]);return(0,o.a)((0,r.useMemo)(()=>[{key:"Enter",ctrl:!0,handler:p,global:!0}],[p])),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("button",{onClick:()=>x&&d(!0),className:`flex items-center gap-1.5 rounded-md px-2 py-1 text-xs transition-colors ${x?"text-amber-700 hover:bg-amber-50 cursor-pointer":"text-gray-400 cursor-default"}`,title:x?`${b} uncommitted`:"No changes to commit",children:[a.jsx("span",{className:`h-2 w-2 rounded-full ${x?"bg-amber-500":"bg-gray-300"}`}),a.jsx("span",{children:x?`${b} uncommitted`:"No changes"})]}),i&&(0,c.createPortal)((0,a.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[a.jsx("div",{className:"absolute inset-0 bg-black/40",onClick:()=>d(!1)}),(0,a.jsxs)("div",{className:"relative rounded-lg border border-gray-200 bg-white shadow-xl w-full max-w-md mx-4 p-5",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h2",{className:"text-sm font-semibold text-gray-900",children:"Uncommitted changes"}),a.jsx("button",{onClick:()=>d(!1),className:"text-gray-400 hover:text-gray-600 text-sm",children:"Esc"})]}),a.jsx("ul",{className:"space-y-2 max-h-64 overflow-y-auto mb-4",children:e.files.map(e=>(0,a.jsxs)("li",{className:"flex items-start justify-between gap-2",children:[(0,a.jsxs)("div",{className:"min-w-0",children:[a.jsx("p",{className:"text-sm text-gray-900 truncate",children:e.title}),a.jsx("p",{className:"text-xs text-gray-400 truncate",children:e.path})]}),a.jsx("span",{className:`mt-0.5 shrink-0 rounded px-1.5 py-0.5 text-[10px] font-medium ${"new"===e.status?"bg-emerald-100 text-emerald-700":"bg-amber-100 text-amber-700"}`,children:e.status})]},e.path))}),m&&a.jsx("p",{className:"mb-3 text-sm text-gray-700",children:m}),e.localMode?a.jsx("p",{className:"text-xs text-gray-500 italic",children:"In local mode, commit from your terminal to avoid conflicts with your working tree."}):a.jsx("button",{onClick:p,disabled:f||!!m,className:"w-full rounded-md bg-amber-600 px-3 py-2 text-sm font-medium text-white hover:bg-amber-700 transition-colors disabled:opacity-50 inline-flex items-center justify-center gap-2",children:f?"Committing...":m||(0,a.jsxs)(a.Fragment,{children:["Commit & Push",a.jsx("kbd",{className:"rounded border border-amber-400 bg-amber-500 px-1 py-0.5 font-mono text-[10px] text-amber-100",children:"^↵"})]})})]})]}),document.body)]})}function f({repos:e,selectedRepo:t,localMode:s}){let i=(0,n.useRouter)(),[c,o]=(0,r.useTransition)();return s||e.length<=1?a.jsx("span",{className:"text-xs text-gray-500",children:s?"viewing local repository":t}):a.jsx("select",{value:t,onChange:function(e){let t=e.target.value;o(async()=>{await (0,l.dj)(t),i.refresh()})},disabled:c,className:"rounded-md border border-gray-200 bg-white px-2 py-1 text-xs text-gray-700 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-1 focus:ring-blue-500 disabled:opacity-50",children:e.map(e=>a.jsx("option",{value:e,children:e},e))})}function u({open:e,onClose:t,docTree:s,gitStatus:r,repos:c,selectedRepo:l,onNewDoc:o}){let u=(0,n.usePathname)();return(0,a.jsxs)(a.Fragment,{children:[e&&a.jsx("div",{className:"fixed inset-0 z-30 bg-black/40 md:hidden",onClick:t}),(0,a.jsxs)("aside",{className:`fixed left-0 top-0 z-40 h-full w-64 transform border-r border-gray-200 bg-white transition-transform duration-200 ease-in-out md:static md:translate-x-0 ${e?"translate-x-0":"-translate-x-full"}`,children:[(0,a.jsxs)("div",{className:"flex h-14 items-center border-b border-gray-200 px-4",children:[a.jsx(i.default,{href:"/",className:"text-lg font-semibold text-gray-900",children:"Focal"}),a.jsx("div",{className:"ml-auto",children:a.jsx(f,{repos:c,selectedRepo:l,localMode:r.localMode})})]}),a.jsx("div",{className:"border-b border-gray-200 px-4 py-2",children:a.jsx(d,{gitStatus:r,selectedRepo:l})}),(0,a.jsxs)("nav",{className:"h-[calc(100%-3.5rem-2.5rem)] overflow-y-auto p-3",children:[(0,a.jsxs)("div",{children:[a.jsx("div",{className:"flex items-center px-3",children:a.jsx("h3",{className:"text-xs font-medium uppercase tracking-wide text-gray-400",children:"Tasks"})}),a.jsx("ul",{className:"mt-1 space-y-0.5",children:a.jsx("li",{children:a.jsx(i.default,{href:"/",onClick:t,className:`block rounded-md px-3 py-1 text-sm transition-colors ${"/"===u||u.startsWith("/task")?"bg-gray-100 text-gray-900 font-medium":"text-gray-600 hover:bg-gray-50 hover:text-gray-900"}`,children:"Kanban View"})})})]}),(0,a.jsxs)("div",{className:"mt-4 border-t border-gray-200 pt-3",children:[a.jsx("div",{className:"flex items-center px-3",children:a.jsx("h3",{className:"text-xs font-medium uppercase tracking-wide text-gray-400",children:"Documentation"})}),0===s.length?a.jsx("p",{className:"mt-1 px-3 text-xs text-gray-400 italic",children:"No docs found"}):a.jsx("ul",{className:"mt-1 space-y-0",children:a.jsx(m,{nodes:s,pathname:u,onClose:t,depth:0,onNewDoc:o})})]})]})]})]})}function m({nodes:e,pathname:t,onClose:s,depth:r,onNewDoc:n}){return a.jsx(a.Fragment,{children:e.map(e=>{let c=`/docs/${e.slug}`,l=t===c,o=e.children&&e.children.length>0,d=`${12+10*r}px`;return a.jsx("li",{children:o?(0,a.jsxs)("div",{className:"group",children:[(0,a.jsxs)("div",{className:"flex items-center",style:{paddingLeft:d},children:[a.jsx("span",{className:"flex-1 truncate rounded-md py-1 text-[11px] font-semibold uppercase tracking-wide text-gray-700",children:e.title}),a.jsx("button",{onClick:()=>n(e.filePath),className:"invisible group-hover:visible mr-1 rounded px-1 py-0.5 text-xs text-gray-400 hover:bg-gray-100 hover:text-gray-700",title:"New doc here",children:"+"})]}),a.jsx("ul",{className:"space-y-0",children:a.jsx(m,{nodes:e.children,pathname:t,onClose:s,depth:r+1,onNewDoc:n})})]}):a.jsx(i.default,{href:c,onClick:s,className:`block truncate rounded-md py-1 text-sm transition-colors ${l?"bg-gray-100 text-gray-900 font-medium":"text-gray-600 hover:bg-gray-50 hover:text-gray-900"}`,style:{paddingLeft:d},children:e.title})},e.slug)})})}var h=s(111);function b({children:e,docTree:t,gitStatus:s,repos:i,selectedRepo:c}){let[l,m]=(0,r.useState)(!1),[b,x]=(0,r.useState)(null),[p,g]=(0,r.useState)(void 0),[y,v]=(0,r.useState)(!1),j=(0,n.usePathname)(),w=(0,r.useCallback)(()=>m(e=>!e),[]),k=(0,r.useCallback)(()=>m(!1),[]),N=(0,r.useCallback)(()=>{x(j.startsWith("/docs")?"doc":"task")},[j]);(0,o.a)((0,r.useMemo)(()=>[{key:"[",handler:w},{key:"n",handler:N}],[w,N])),(0,r.useCallback)(()=>x("task"),[]);let S=(0,r.useCallback)(e=>{g(e),x("doc")},[]),$=(0,r.useCallback)(()=>{x(null),g(void 0)},[]);return(0,a.jsxs)("div",{className:"flex min-h-screen flex-col",children:[y&&(0,a.jsxs)("div",{className:"border-b border-amber-200 bg-amber-50 px-4 py-2 text-center text-sm text-amber-900",children:["This is Focal running against its own"," ",a.jsx("a",{href:"https://github.com/tonioab49/focal",target:"_blank",rel:"noreferrer",className:"underline underline-offset-2 hover:text-amber-950",children:"Github repo"}),". Feel free to report bugs and create tasks directly from here."]}),(0,a.jsxs)("div",{className:"flex min-h-0 flex-1",children:[a.jsx(u,{open:l,onClose:k,docTree:t,gitStatus:s,repos:i,selectedRepo:c,onNewDoc:S}),(0,a.jsxs)("div",{className:"flex flex-1 flex-col",children:[(0,a.jsxs)("header",{className:"flex h-14 items-center border-b border-gray-200 px-4 md:hidden",children:[a.jsx("button",{onClick:w,className:"rounded-md p-2 text-gray-600 hover:bg-gray-100 hover:text-gray-900","aria-label":"Toggle sidebar",children:a.jsx("svg",{className:"h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})}),(0,a.jsxs)("div",{className:"ml-3 flex items-center gap-2",children:[a.jsx("span",{className:"text-lg font-semibold text-gray-900",children:"Focal"}),i.length>1&&a.jsx(f,{repos:i,selectedRepo:c,localMode:s.localMode})]}),a.jsx("div",{className:"ml-auto",children:a.jsx(d,{gitStatus:s,selectedRepo:c})})]}),a.jsx("main",{className:"flex-1 overflow-auto",children:e})]})]}),null!==b&&a.jsx(h.r,{type:b,repoName:c,parentDir:p,onClose:$})]})}},111:(e,t,s)=>{"use strict";s.d(t,{r:()=>l});var a=s(326),r=s(7577),n=s(5047),i=s(8176),c=s(8033);function l({type:e,repoName:t,parentDir:s,onClose:l}){let o=(0,n.useRouter)(),[d,f]=(0,r.useState)(""),[u,m]=(0,r.useTransition)(),h=(0,r.useCallback)(()=>l(),[l]);return(0,i.a)((0,r.useMemo)(()=>[{key:"Escape",global:!0,handler:h}],[h])),(0,a.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[a.jsx("div",{className:"absolute inset-0 bg-black/40",onClick:l}),(0,a.jsxs)("div",{className:"relative rounded-lg border border-gray-200 bg-white shadow-xl w-full max-w-md mx-4 p-5",children:[a.jsx("h2",{className:"text-sm font-semibold text-gray-900 mb-4",children:"task"===e?"New task":"New document"}),(0,a.jsxs)("form",{onSubmit:function(a){a.preventDefault(),d.trim()&&!u&&m(async()=>{if("task"===e){let{taskId:e}=await (0,c.vr)({title:d.trim(),repoName:t});o.push(`/task/${e}`)}else{let{slug:e}=await (0,c.do)({title:d.trim(),repoName:t,parentDir:s});o.push(`/docs/${e}`)}l()})},children:[a.jsx("input",{type:"text",value:d,onChange:e=>f(e.target.value),placeholder:"Title",autoFocus:!0,disabled:u,className:"w-full rounded-md border border-gray-300 px-3 py-2 text-sm text-gray-900 placeholder-gray-400 focus:border-gray-500 focus:outline-none focus:ring-1 focus:ring-gray-500 disabled:opacity-50"}),(0,a.jsxs)("div",{className:"mt-4 flex justify-end gap-2",children:[a.jsx("button",{type:"button",onClick:l,disabled:u,className:"rounded-md px-3 py-1.5 text-sm text-gray-600 hover:bg-gray-100 disabled:opacity-50",children:"Cancel"}),a.jsx("button",{type:"submit",disabled:!d.trim()||u,className:"rounded-md bg-blue-600 px-4 py-2 text-sm font-medium text-white shadow-sm hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors disabled:opacity-50",children:u?"Creating…":"Create"})]})]})]})]})}},744:(e,t,s)=>{"use strict";s.d(t,{ShortcutHelp:()=>c});var a=s(326),r=s(7577),n=s(8176);let i=[{title:"Board",shortcuts:[{keys:["N"],label:"New task"},{keys:["J","↓"],label:"Move down"},{keys:["K","↑"],label:"Move up"},{keys:["H","←"],label:"Move left"},{keys:["L","→"],label:"Move right"},{keys:["↵"],label:"Open task"},{keys:["Esc"],label:"Clear selection"}]},{title:"Task Edit",shortcuts:[{keys:["⌘S"],label:"Save task"},{keys:["Esc"],label:"Back to board"}]},{title:"Docs",shortcuts:[{keys:["N"],label:"New document"},{keys:["E"],label:"Edit document"},{keys:["⌘S"],label:"Save document"},{keys:["Esc"],label:"Cancel editing"}]},{title:"Global",shortcuts:[{keys:["["],label:"Toggle sidebar"},{keys:["Ctrl+↵"],label:"Commit changes"},{keys:["?"],label:"Toggle this help"}]}];function c(){let[e,t]=(0,r.useState)(!1),s=(0,r.useCallback)(()=>t(e=>!e),[]);return((0,n.a)((0,r.useMemo)(()=>[{key:"?",shift:!0,handler:s}],[s])),e)?(0,a.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[a.jsx("div",{className:"absolute inset-0 bg-black/40",onClick:()=>t(!1)}),(0,a.jsxs)("div",{className:"relative rounded-lg border border-gray-200 bg-white shadow-xl w-full max-w-md mx-4 p-5",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h2",{className:"text-sm font-semibold text-gray-900",children:"Keyboard shortcuts"}),a.jsx("button",{onClick:()=>t(!1),className:"text-gray-400 hover:text-gray-600 text-sm",children:"Esc"})]}),a.jsx("div",{className:"space-y-4",children:i.map(e=>(0,a.jsxs)("div",{children:[a.jsx("h3",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide mb-2",children:e.title}),a.jsx("div",{className:"space-y-1.5",children:e.shortcuts.map(e=>(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-sm text-gray-700",children:e.label}),a.jsx("div",{className:"flex items-center gap-1",children:e.keys.map(e=>a.jsx("kbd",{className:"inline-flex min-w-[22px] items-center justify-center rounded border border-gray-300 bg-gray-50 px-1.5 py-0.5 font-mono text-xs text-gray-600",children:e},e))})]},e.label))})]},e.title))})]})]}):null}},8176:(e,t,s)=>{"use strict";function a(e){}s.d(t,{a:()=>a}),s(7577)},9053:(e,t,s)=>{"use strict";s.r(t),s.d(t,{commitChanges:()=>P,createDoc:()=>S,createTask:()=>N,getGitStatus:()=>w,getRepoList:()=>g,getSelectedRepo:()=>p,getUncommittedFiles:()=>k,saveDoc:()=>v,saveTask:()=>y,setSelectedRepo:()=>x});var a=s(4330);s(166);var r=s(7561),n=s.n(r),i=s(7718),c=s(9411),l=s.n(c),o=s(3673),d=s.n(o),f=s(7708),u=s(1615),m=s(8154),h=s(618);let b="focal-repo";async function x(e){(await (0,u.cookies)()).set(b,e,{path:"/",maxAge:31536e3}),(0,f.revalidatePath)("/")}async function p(){let e=await (0,u.cookies)();return e.get(b)?.value}async function g(){return(0,m.HA)().map(e=>e.name)}async function y(e){let{filePath:t,title:s,status:a,priority:r,assignee:i,body:c}=e,o=l().resolve(t),u=(0,m.gk)()?(0,m.HB)():m.n7;if(!o.startsWith(u+l().sep)||!o.includes(`${l().sep}.focal${l().sep}tasks${l().sep}`))throw Error("Invalid file path");let h=n().readFileSync(o,"utf-8"),{content:b}=d()(h),x={title:s,status:a};r&&(x.priority=r),i&&(x.assignee=i);let p=d().stringify(void 0!==c?c:b,x);n().writeFileSync(o,p,"utf-8"),(0,f.revalidatePath)("/"),(0,f.revalidatePath)("/task")}async function v(e){let{filePath:t,content:s}=e,a=l().resolve(t),r=l().sep,i=(0,m.gk)()?(0,m.HB)():m.n7;if(!a.startsWith(i+r)||!a.endsWith(".md")&&!a.endsWith(".mdx")||a.includes(r+".focal"+r+"tasks"+r))throw Error("Invalid file path");n().writeFileSync(a,s,"utf-8"),(0,f.revalidatePath)("/"),(0,f.revalidatePath)("/docs")}function j(e,t,s){return e.trim()?e.split("\n").filter(Boolean).map(e=>({statusChars:e.slice(0,2),filePath:$(e)})).filter(({filePath:e})=>e.endsWith(".md")||e.endsWith(".mdx")).map(({statusChars:e,filePath:a})=>{let{title:r,kind:i}=function(e,t){let s=e.startsWith(".focal/tasks/")||e.includes("/.focal/tasks/");if(s){let s=l().join(t,e);if(n().existsSync(s))try{let e=n().readFileSync(s,"utf-8"),{data:t}=d()(e);if(t.title)return{title:t.title,kind:"task"}}catch{}}return{title:l().basename(e).replace(/\.\w+$/,"").replace(/-/g," ").replace(/\b\w/g,e=>e.toUpperCase()),kind:s?"task":"doc"}}(a,s);return{path:`${t}/${a}`,title:r,kind:i,status:"??"===e.trim()?"new":"modified"}}):[]}async function w(e){if((0,m.gk)()){let e=(0,m.HB)(),t=l().basename(e);try{let s=(0,i.execSync)("git status --porcelain",{cwd:e,encoding:"utf-8"}).trimEnd();return{localMode:!0,files:j(s,t,e)}}catch{return{localMode:!0,files:[]}}}let t=(0,m.Nj)(),s=[];for(let a of t){if(e&&a!==e)continue;let t=(0,m.Po)(a);try{let e=(0,i.execSync)("git status --porcelain",{cwd:t,encoding:"utf-8"}).trimEnd();s.push(...j(e,a,t))}catch{}}return{localMode:!1,files:s}}async function k(){if((0,m.gk)()){let e=(0,m.HB)(),t=l().basename(e);try{let s=(0,i.execSync)("git status --porcelain",{cwd:e,encoding:"utf-8"}).trimEnd();if(!s.trim())return[];return s.split("\n").filter(Boolean).map($).filter(e=>e.endsWith(".md")||e.endsWith(".mdx")).map(e=>`${t}/${e}`)}catch{return[]}}let e=(0,m.Nj)(),t=[];for(let s of e){let e=(0,m.Po)(s);try{let a=(0,i.execSync)("git status --porcelain",{cwd:e,encoding:"utf-8"}).trimEnd();if(a.trim())for(let e of a.split("\n").filter(Boolean)){let a=$(e);(a.endsWith(".md")||a.endsWith(".mdx"))&&t.push(`${s}/${a}`)}}catch{}}return t}async function N({title:e,repoName:t}){let s,a;let r=e.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/^-+|-+$/g,"");if((0,m.gk)())s=(0,m.HB)(),a=l().basename(s);else{if(!t)throw Error("repoName required in multi-repo mode");s=(0,m.Po)(t),a=t}let i=l().join(s,".focal","tasks");n().mkdirSync(i,{recursive:!0});let c=r,o=2;for(;n().existsSync(l().join(i,`${c}.mdx`));)c=`${r}-${o}`,o++;let u=l().join(i,`${c}.mdx`),h=l().resolve(u),b=(0,m.gk)()?(0,m.HB)():m.n7;if(!h.startsWith(b+l().sep)||!h.includes(`${l().sep}.focal${l().sep}tasks${l().sep}`))throw Error("Invalid file path");let x=d().stringify("",{title:e,status:"todo"});return n().writeFileSync(h,x,"utf-8"),(0,f.revalidatePath)("/"),{taskId:`${a}/${c}`}}async function S({title:e,repoName:t,parentDir:s}){let a,r;let i=e.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/^-+|-+$/g,"");if((0,m.gk)())a=(0,m.HB)(),r=l().basename(a);else{if(!t)throw Error("repoName required in multi-repo mode");a=(0,m.Po)(t),r=t}let c=(0,m.gk)()?(0,m.HB)():m.n7,o=s?l().resolve(s):l().join(a,".focal","docs");n().mkdirSync(o,{recursive:!0});let d=i,u=2;for(;n().existsSync(l().join(o,`${d}.md`));)d=`${i}-${u}`,u++;let h=l().join(o,`${d}.md`),b=l().resolve(h);if(!b.startsWith(c+l().sep))throw Error("Invalid file path");if(!b.endsWith(".md")&&!b.endsWith(".mdx"))throw Error("Invalid file extension");if(b.includes(l().sep+".focal"+l().sep+"tasks"+l().sep))throw Error("Cannot create doc in tasks directory");n().writeFileSync(b,"","utf-8");let x=l().relative(a,b).replace(/\.(md|mdx)$/,"").replace(/\\/g,"/");return(0,f.revalidatePath)("/docs"),{slug:`${r}/${x}`}}function $(e){return e.slice(3)}function C(e){return e.split("\n").filter(Boolean).map($).filter(e=>(e.endsWith(".md")||e.endsWith(".mdx"))&&!e.startsWith(".focal/tasks/"))}async function P(e){if((0,m.gk)()){let e=(0,m.HB)();try{let t=(0,i.execSync)("git status --porcelain",{cwd:e,encoding:"utf-8"}).trimEnd();if(!t.trim())return{message:"No changes to commit"};let s=l().join(e,".focal","tasks");for(let a of(n().existsSync(s)&&(0,i.execSync)("git add -- .focal/tasks/",{cwd:e}),C(t)))(0,i.execSync)(`git add -- ${JSON.stringify(a)}`,{cwd:e});if(!(0,i.execSync)("git diff --cached --name-only",{cwd:e,encoding:"utf-8"}).trim())return{message:"No changes to commit"};(0,i.execSync)('git commit -m "Update focal content"',{cwd:e});try{(0,m.wf)(e)}catch{}return(0,f.revalidatePath)("/"),{message:"Committed changes"}}catch{return(0,f.revalidatePath)("/"),{message:"Failed to commit changes"}}}let t=(0,m.Nj)(),s=0,a=[];for(let r of t){if(e&&r!==e)continue;let t=(0,m.Po)(r);try{let e=(0,i.execSync)("git status --porcelain",{cwd:t,encoding:"utf-8"}).trimEnd();if(!e.trim()||!e.split("\n").filter(Boolean).some(e=>{let t=$(e);return t.endsWith(".md")||t.endsWith(".mdx")}))continue;let c=l().join(t,".focal","tasks");for(let s of(n().existsSync(c)&&(0,i.execSync)("git add -- .focal/tasks/",{cwd:t}),C(e)))(0,i.execSync)(`git add -- ${JSON.stringify(s)}`,{cwd:t});if(!(0,i.execSync)("git diff --cached --name-only",{cwd:t,encoding:"utf-8"}).trim())continue;(0,i.execSync)('git commit -m "Update focal content"',{cwd:t});try{(0,m.ly)(t)}catch{a.push(`Rebase failed for ${r}`);continue}try{(0,m.wf)(t)}catch{a.push(`Push failed for ${r}`);continue}s++}catch{}}return((0,f.revalidatePath)("/"),a.length>0)?{message:a.join("; ")}:0===s?{message:"No changes to commit"}:{message:`Committed and pushed in ${s} ${1===s?"repository":"repositories"}`}}(0,h.h)([x,p,g,y,v,w,k,N,S,P]),(0,a.j)("29d9cd11d097fcb6690a26ef774aeeee260b389b",x),(0,a.j)("bfa1de4d25904e288eea8780fb8c48c13f8304d2",p),(0,a.j)("ac8031647eec6a4700a6a90d39c2af1c1d5bd267",g),(0,a.j)("0b32d0e7a9e913867bfb2724e5c71bc874ca9624",y),(0,a.j)("d36e843f1a3e9ed7e591d8cb5f8779c3f4ad0876",v),(0,a.j)("48e24bf6b7790941829c1b47555db59c45439f76",w),(0,a.j)("5896e2c5181e1accf5bdf86f55c5717bc2bfa048",k),(0,a.j)("5171b9bc6fa8d6fb730de54219624f90f34cbafd",N),(0,a.j)("f53de7a8283b631e23b5e166f5d38eeac215e2cd",S),(0,a.j)("4810e0847edab22d875d1f15f89918103c558ebd",P)},9097:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>f,dynamic:()=>d,metadata:()=>o});var a=s(9510),r=s(8570);let n=(0,r.createProxy)(String.raw`/Users/antoine/src/focal/src/components/AppShell.tsx#AppShell`),i=(0,r.createProxy)(String.raw`/Users/antoine/src/focal/src/components/ShortcutHelp.tsx#ShortcutHelp`);var c=s(8627),l=s(9053);s(5023);let o={title:"Focal",description:"File-centric task and documentation manager for software projects"},d="force-dynamic";async function f({children:e}){let t=await (0,l.getRepoList)(),s=await (0,l.getSelectedRepo)(),r=s&&t.includes(s)?s:t[0],o=(0,c.os)(r),d=await (0,l.getGitStatus)(r);return a.jsx("html",{lang:"en",children:(0,a.jsxs)("body",{children:[a.jsx(n,{docTree:o,gitStatus:d,repos:t,selectedRepo:r,children:e}),a.jsx(i,{})]})})}},8627:(e,t,s)=>{"use strict";s.d(t,{$O:()=>f,Kp:()=>m,P:()=>u,os:()=>d});var a=s(7561),r=s.n(a),n=s(9411),i=s.n(n),c=s(7718),l=s(8154);function o(e){return e.replace(/-/g," ").replace(/\b\w/g,e=>e.toUpperCase())}function d(e){let t=(0,l.HA)(),s=[];for(let a of t){if(e&&a.name!==e)continue;let t=function(e){let t=function(e){let t=i().join(e,".focal",".focalignore");try{return r().readFileSync(t,"utf-8").split("\n").map(e=>e.trim()).filter(e=>e&&!e.startsWith("#"))}catch{return[]}}(e),s="";try{s+=(0,c.execSync)("git ls-files -- '*.md' '*.mdx'",{cwd:e,encoding:"utf-8"})}catch{}try{s+=(0,c.execSync)("git ls-files --others --exclude-standard -- '*.md' '*.mdx'",{cwd:e,encoding:"utf-8"})}catch{}return Array.from(new Set(s.split("\n").filter(Boolean))).filter(e=>(function(e){if(e.startsWith(".focal/docs/"))return!0;if(e.startsWith(".focal/"))return!1;for(let t of e.split("/"))if(t.startsWith("."))return!1;return!0})(e)&&!function(e,t){let s=e.split("/");for(let a of t)if(a.endsWith("/")){let e=a.slice(0,-1);if(s.slice(0,-1).includes(e))return!0}else if(a.includes("*")){let t=RegExp("^"+a.replace(/[.+^${}()|[\]\\]/g,"\\$&").replace(/\*/g,"[^/]*")+"$");if(t.test(e)||s.some(e=>t.test(e)))return!0}else if(e===a||s[s.length-1]===a)return!0;return!1}(e,t))}(a.path);if(0===t.length)continue;let n=function e(t,s,a,r){let n=[],c=new Map;for(let e of t){let t=e.indexOf("/");if(-1===t)n.push(e);else{let s=e.slice(0,t),a=e.slice(t+1);c.has(s)||c.set(s,[]),c.get(s).push(a)}}let l=[];for(let e of n){let t=e.replace(/\.(md|mdx)$/,""),n=s?`${s}/${t}`:t;l.push({slug:`${a}/${n}`,title:o(t),filePath:i().join(r,s,e),repository:a})}for(let[t,n]of Array.from(c)){let c=s?`${s}/${t}`:t,d=e(n,c,a,r);d.length>0&&l.push({slug:`${a}/${c}`,title:o(t),filePath:i().join(r,c),repository:a,children:d})}return l.sort((e,t)=>"index"===e.title.toLowerCase()?-1:"index"===t.title.toLowerCase()?1:e.title.localeCompare(t.title)),l}(t,"",a.name,a.path);s.push(...n)}return s}function f(e){let t=[];for(let s of e)s.children?t.push(...f(s.children)):t.push(s);return t}function u(e){return f(d()).find(t=>t.slug===e)??null}function m(e){return r().readFileSync(e,"utf-8")}},8154:(e,t,s)=>{"use strict";s.d(t,{HA:()=>x,HB:()=>u,Nj:()=>m,Po:()=>h,gk:()=>f,ly:()=>g,n7:()=>o,wf:()=>p});var a=s(7561),r=s.n(a),n=s(9411),i=s.n(n),c=s(7718);let l=/^[a-zA-Z0-9_.-]+\/[a-zA-Z0-9_.-]+$/,o="/tmp/focal/repos",d=new Set;function f(){let e=process.env.GITHUB_REPOS;return!e||""===e.trim()}function u(e=process.env.FOCAL_CWD??process.cwd()){let t=i().resolve(e);for(;;){if(r().existsSync(i().join(t,".git")))return t;let e=i().dirname(t);if(e===t)throw Error("Not inside a git repository");t=e}}function m(){let e=process.env.GITHUB_REPOS;if(!e)return[];let t=e.split(",").map(e=>e.trim()).filter(Boolean),s=[];for(let e of t)l.test(e)?s.push(e):console.warn(`[focal] Ignoring invalid repo slug: ${e}`);return s}function h(e){let[t,s]=e.split("/");return i().join(o,t,s)}function b(e){let t=h(e),s=i().dirname(t);r().mkdirSync(s,{recursive:!0}),(0,c.execSync)(`git clone --depth 1 ${function(e){let t=process.env.GITHUB_TOKEN;return t?`https://x-access-token:${t}@github.com/${e}.git`:`https://github.com/${e}.git`}(e)} ${t}`,{stdio:"pipe",timeout:6e4})}function x(){if(f())try{return[function(){let e=u();return{name:i().basename(e),path:e}}()]}catch{throw Error('No GITHUB_REPOS configured and not inside a git repository. Set the GITHUB_REPOS environment variable (e.g. "owner/repo") to use remote mode.')}let e=m(),t=[];for(let s of e)try{(function(e){if(d.has(e))return;let t=h(e);r().existsSync(i().join(t,".git"))?function(e){let t=h(e);try{(0,c.execSync)("git fetch origin",{cwd:t,stdio:"pipe",timeout:3e4});let e=(0,c.execSync)("git rev-parse --abbrev-ref HEAD",{cwd:t,stdio:"pipe"}).toString().trim();(0,c.execSync)(`git reset --hard origin/${e}`,{cwd:t,stdio:"pipe"})}catch(a){let s=a instanceof Error?a.message:String(a);s.includes("not a git repository")?(console.warn(`[focal] ${e} is corrupted, re-cloning`),r().rmSync(t,{recursive:!0,force:!0}),b(e)):console.warn(`[focal] git pull failed for ${e}: ${s}`)}}(e):b(e),d.add(e)})(s),t.push({name:s,path:h(s)})}catch(a){console.warn(`[focal] Failed to sync ${s}: ${a instanceof Error?a.message:a}`);let e=h(s);r().existsSync(i().join(e,".git"))&&t.push({name:s,path:e})}return t}function p(e){(0,c.execSync)("git push",{cwd:e,stdio:"pipe",timeout:3e4})}function g(e){(0,c.execSync)("git fetch origin",{cwd:e,stdio:"pipe",timeout:3e4});let t=(0,c.execSync)("git rev-parse --abbrev-ref HEAD",{cwd:e,stdio:"pipe"}).toString().trim();if(!t||"HEAD"===t)throw Error("Cannot rebase detached HEAD");try{(0,c.execSync)(`git rebase origin/${t}`,{cwd:e,stdio:"pipe",timeout:3e4})}catch(t){try{(0,c.execSync)("git rebase --abort",{cwd:e,stdio:"pipe",timeout:3e4})}catch{}throw t}}},5023:()=>{}};