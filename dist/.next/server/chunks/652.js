exports.id=652,exports.ids=[652],exports.modules={4226:(e,t,s)=>{let a={"0b32d0e7a9e913867bfb2724e5c71bc874ca9624":()=>Promise.resolve().then(s.bind(s,9053)).then(e=>e.saveTask),"29d9cd11d097fcb6690a26ef774aeeee260b389b":()=>Promise.resolve().then(s.bind(s,9053)).then(e=>e.setSelectedRepo),"4810e0847edab22d875d1f15f89918103c558ebd":()=>Promise.resolve().then(s.bind(s,9053)).then(e=>e.commitChanges),"48e24bf6b7790941829c1b47555db59c45439f76":()=>Promise.resolve().then(s.bind(s,9053)).then(e=>e.getGitStatus),"5171b9bc6fa8d6fb730de54219624f90f34cbafd":()=>Promise.resolve().then(s.bind(s,9053)).then(e=>e.createTask),"5896e2c5181e1accf5bdf86f55c5717bc2bfa048":()=>Promise.resolve().then(s.bind(s,9053)).then(e=>e.getUncommittedFiles),ac8031647eec6a4700a6a90d39c2af1c1d5bd267:()=>Promise.resolve().then(s.bind(s,9053)).then(e=>e.getRepoList),bfa1de4d25904e288eea8780fb8c48c13f8304d2:()=>Promise.resolve().then(s.bind(s,9053)).then(e=>e.getSelectedRepo),d36e843f1a3e9ed7e591d8cb5f8779c3f4ad0876:()=>Promise.resolve().then(s.bind(s,9053)).then(e=>e.saveDoc),f53de7a8283b631e23b5e166f5d38eeac215e2cd:()=>Promise.resolve().then(s.bind(s,9053)).then(e=>e.createDoc)};async function r(e,...t){return(await a[e]()).apply(null,t)}e.exports={"0b32d0e7a9e913867bfb2724e5c71bc874ca9624":r.bind(null,"0b32d0e7a9e913867bfb2724e5c71bc874ca9624"),"29d9cd11d097fcb6690a26ef774aeeee260b389b":r.bind(null,"29d9cd11d097fcb6690a26ef774aeeee260b389b"),"4810e0847edab22d875d1f15f89918103c558ebd":r.bind(null,"4810e0847edab22d875d1f15f89918103c558ebd"),"48e24bf6b7790941829c1b47555db59c45439f76":r.bind(null,"48e24bf6b7790941829c1b47555db59c45439f76"),"5171b9bc6fa8d6fb730de54219624f90f34cbafd":r.bind(null,"5171b9bc6fa8d6fb730de54219624f90f34cbafd"),"5896e2c5181e1accf5bdf86f55c5717bc2bfa048":r.bind(null,"5896e2c5181e1accf5bdf86f55c5717bc2bfa048"),ac8031647eec6a4700a6a90d39c2af1c1d5bd267:r.bind(null,"ac8031647eec6a4700a6a90d39c2af1c1d5bd267"),bfa1de4d25904e288eea8780fb8c48c13f8304d2:r.bind(null,"bfa1de4d25904e288eea8780fb8c48c13f8304d2"),d36e843f1a3e9ed7e591d8cb5f8779c3f4ad0876:r.bind(null,"d36e843f1a3e9ed7e591d8cb5f8779c3f4ad0876"),f53de7a8283b631e23b5e166f5d38eeac215e2cd:r.bind(null,"f53de7a8283b631e23b5e166f5d38eeac215e2cd")}},8586:(e,t,s)=>{Promise.resolve().then(s.t.bind(s,2994,23)),Promise.resolve().then(s.t.bind(s,6114,23)),Promise.resolve().then(s.t.bind(s,9727,23)),Promise.resolve().then(s.t.bind(s,9671,23)),Promise.resolve().then(s.t.bind(s,1868,23)),Promise.resolve().then(s.t.bind(s,4759,23))},2988:(e,t,s)=>{Promise.resolve().then(s.bind(s,2456)),Promise.resolve().then(s.bind(s,744))},8033:(e,t,s)=>{"use strict";s.d(t,{F9:()=>c,MF:()=>l,VA:()=>r,dj:()=>n,do:()=>o,vr:()=>i}),s(5424);var a=s(6242),r=(0,a.$)("4810e0847edab22d875d1f15f89918103c558ebd"),n=(0,a.$)("29d9cd11d097fcb6690a26ef774aeeee260b389b");(0,a.$)("bfa1de4d25904e288eea8780fb8c48c13f8304d2"),(0,a.$)("ac8031647eec6a4700a6a90d39c2af1c1d5bd267");var c=(0,a.$)("0b32d0e7a9e913867bfb2724e5c71bc874ca9624"),l=(0,a.$)("d36e843f1a3e9ed7e591d8cb5f8779c3f4ad0876");(0,a.$)("48e24bf6b7790941829c1b47555db59c45439f76"),(0,a.$)("5896e2c5181e1accf5bdf86f55c5717bc2bfa048");var i=(0,a.$)("5171b9bc6fa8d6fb730de54219624f90f34cbafd"),o=(0,a.$)("f53de7a8283b631e23b5e166f5d38eeac215e2cd")},2456:(e,t,s)=>{"use strict";s.d(t,{AppShell:()=>h});var a=s(326),r=s(7577),n=s(5047),c=s(434),l=s(962),i=s(8033),o=s(8176);function d({gitStatus:e,selectedRepo:t}){let s=(0,n.useRouter)(),[c,d]=(0,r.useState)(!1),[f,u]=(0,r.useTransition)(),[m,b]=(0,r.useState)(null),h=e.files.length,x=h>0,p=(0,r.useCallback)(()=>{f||e.localMode||u(async()=>{b((await (0,i.VA)(t)).message),s.refresh()})},[f,e.localMode,t,s]);return(0,o.a)((0,r.useMemo)(()=>[{key:"Enter",ctrl:!0,handler:p,global:!0}],[p])),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("button",{onClick:()=>x&&d(!0),className:`flex items-center gap-1.5 rounded-md px-2 py-1 text-xs transition-colors ${x?"text-amber-700 hover:bg-amber-50 cursor-pointer":"text-gray-400 cursor-default"}`,title:x?`${h} uncommitted`:"No changes to commit",children:[a.jsx("span",{className:`h-2 w-2 rounded-full ${x?"bg-amber-500":"bg-gray-300"}`}),a.jsx("span",{children:x?`${h} uncommitted`:"No changes"})]}),c&&(0,l.createPortal)((0,a.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[a.jsx("div",{className:"absolute inset-0 bg-black/40",onClick:()=>d(!1)}),(0,a.jsxs)("div",{className:"relative rounded-lg border border-gray-200 bg-white shadow-xl w-full max-w-md mx-4 p-5",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h2",{className:"text-sm font-semibold text-gray-900",children:"Uncommitted changes"}),a.jsx("button",{onClick:()=>d(!1),className:"text-gray-400 hover:text-gray-600 text-sm",children:"Esc"})]}),a.jsx("ul",{className:"space-y-2 max-h-64 overflow-y-auto mb-4",children:e.files.map(e=>(0,a.jsxs)("li",{className:"flex items-start justify-between gap-2",children:[(0,a.jsxs)("div",{className:"min-w-0",children:[a.jsx("p",{className:"text-sm text-gray-900 truncate",children:e.title}),a.jsx("p",{className:"text-xs text-gray-400 truncate",children:e.path})]}),a.jsx("span",{className:`mt-0.5 shrink-0 rounded px-1.5 py-0.5 text-[10px] font-medium ${"new"===e.status?"bg-emerald-100 text-emerald-700":"bg-amber-100 text-amber-700"}`,children:e.status})]},e.path))}),m&&a.jsx("p",{className:"mb-3 text-sm text-gray-700",children:m}),e.localMode?a.jsx("p",{className:"text-xs text-gray-500 italic",children:"In local mode, commit from your terminal to avoid conflicts with your working tree."}):a.jsx("button",{onClick:p,disabled:f||!!m,className:"w-full rounded-md bg-amber-600 px-3 py-2 text-sm font-medium text-white hover:bg-amber-700 transition-colors disabled:opacity-50 inline-flex items-center justify-center gap-2",children:f?"Committing...":m||(0,a.jsxs)(a.Fragment,{children:["Commit & Push",a.jsx("kbd",{className:"rounded border border-amber-400 bg-amber-500 px-1 py-0.5 font-mono text-[10px] text-amber-100",children:"^↵"})]})})]})]}),document.body)]})}function f({repos:e,selectedRepo:t,localMode:s}){let c=(0,n.useRouter)(),[l,o]=(0,r.useTransition)();return s||e.length<=1?a.jsx("span",{className:"text-xs text-gray-500",children:s?"viewing local repository":t}):a.jsx("select",{value:t,onChange:function(e){let t=e.target.value;o(async()=>{await (0,i.dj)(t),c.refresh()})},disabled:l,className:"rounded-md border border-gray-200 bg-white px-2 py-1 text-xs text-gray-700 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-1 focus:ring-blue-500 disabled:opacity-50",children:e.map(e=>a.jsx("option",{value:e,children:e},e))})}function u({open:e,onClose:t,docTree:s,gitStatus:r,repos:l,selectedRepo:i,onNewTask:o,onNewDoc:u}){let b=(0,n.usePathname)();return(0,a.jsxs)(a.Fragment,{children:[e&&a.jsx("div",{className:"fixed inset-0 z-30 bg-black/40 md:hidden",onClick:t}),(0,a.jsxs)("aside",{className:`fixed left-0 top-0 z-40 h-full w-64 transform border-r border-gray-200 bg-white transition-transform duration-200 ease-in-out md:static md:translate-x-0 ${e?"translate-x-0":"-translate-x-full"}`,children:[(0,a.jsxs)("div",{className:"flex h-14 items-center border-b border-gray-200 px-4",children:[a.jsx(c.default,{href:"/",className:"text-lg font-semibold text-gray-900",children:"Focal"}),a.jsx("div",{className:"ml-auto",children:a.jsx(f,{repos:l,selectedRepo:i,localMode:r.localMode})})]}),a.jsx("div",{className:"border-b border-gray-200 px-4 py-2",children:a.jsx(d,{gitStatus:r,selectedRepo:i})}),(0,a.jsxs)("nav",{className:"h-[calc(100%-3.5rem-2.5rem)] overflow-y-auto p-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex items-center justify-between px-3",children:[a.jsx("h3",{className:"text-xs font-medium uppercase tracking-wide text-gray-400",children:"Tasks"}),a.jsx("button",{onClick:o,className:"rounded border border-gray-300 px-1.5 py-0.5 text-[10px] font-medium text-gray-500 hover:border-blue-600 hover:bg-blue-600 hover:text-white transition-colors",children:"New"})]}),a.jsx("ul",{className:"mt-1 space-y-0.5",children:a.jsx("li",{children:a.jsx(c.default,{href:"/",onClick:t,className:`block rounded-md px-3 py-1 text-sm transition-colors ${"/"===b||b.startsWith("/task")?"bg-gray-100 text-gray-900 font-medium":"text-gray-600 hover:bg-gray-50 hover:text-gray-900"}`,children:"Kanban View"})})})]}),(0,a.jsxs)("div",{className:"mt-4 border-t border-gray-200 pt-3",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between px-3",children:[a.jsx("h3",{className:"text-xs font-medium uppercase tracking-wide text-gray-400",children:"Documentation"}),a.jsx("button",{onClick:u,className:"rounded border border-gray-300 px-1.5 py-0.5 text-[10px] font-medium text-gray-500 hover:border-blue-600 hover:bg-blue-600 hover:text-white transition-colors",children:"New"})]}),0===s.length?a.jsx("p",{className:"mt-1 px-3 text-xs text-gray-400 italic",children:"No docs found"}):a.jsx("ul",{className:"mt-1 space-y-0",children:a.jsx(m,{nodes:s,pathname:b,onClose:t,depth:0})})]})]})]})]})}function m({nodes:e,pathname:t,onClose:s,depth:r}){return a.jsx(a.Fragment,{children:e.map(e=>{let n=`/docs/${e.slug}`,l=t===n,i=e.children&&e.children.length>0,o=`${12+10*r}px`;return a.jsx("li",{children:i?(0,a.jsxs)("div",{children:[a.jsx("span",{className:"block truncate rounded-md py-1 text-[11px] font-semibold uppercase tracking-wide text-gray-500",style:{paddingLeft:o},children:e.title}),a.jsx("ul",{className:"space-y-0",children:a.jsx(m,{nodes:e.children,pathname:t,onClose:s,depth:r+1})})]}):a.jsx(c.default,{href:n,onClick:s,className:`block truncate rounded-md py-1 text-sm transition-colors ${l?"bg-gray-100 text-gray-900 font-medium":"text-gray-600 hover:bg-gray-50 hover:text-gray-900"}`,style:{paddingLeft:o},children:e.title})},e.slug)})})}var b=s(111);function h({children:e,docTree:t,gitStatus:s,repos:c,selectedRepo:l}){let[i,m]=(0,r.useState)(!1),[h,x]=(0,r.useState)(null),p=(0,n.usePathname)(),g=(0,r.useCallback)(()=>m(e=>!e),[]),y=(0,r.useCallback)(()=>m(!1),[]),j=(0,r.useCallback)(()=>{x(p.startsWith("/docs")?"doc":"task")},[p]);(0,o.a)((0,r.useMemo)(()=>[{key:"[",handler:g},{key:"n",handler:j}],[g,j]));let v=(0,r.useCallback)(()=>x("task"),[]),w=(0,r.useCallback)(()=>x("doc"),[]),k=(0,r.useCallback)(()=>x(null),[]);return(0,a.jsxs)("div",{className:"flex min-h-screen",children:[a.jsx(u,{open:i,onClose:y,docTree:t,gitStatus:s,repos:c,selectedRepo:l,onNewTask:v,onNewDoc:w}),(0,a.jsxs)("div",{className:"flex flex-1 flex-col",children:[(0,a.jsxs)("header",{className:"flex h-14 items-center border-b border-gray-200 px-4 md:hidden",children:[a.jsx("button",{onClick:g,className:"rounded-md p-2 text-gray-600 hover:bg-gray-100 hover:text-gray-900","aria-label":"Toggle sidebar",children:a.jsx("svg",{className:"h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})}),(0,a.jsxs)("div",{className:"ml-3 flex items-center gap-2",children:[a.jsx("span",{className:"text-lg font-semibold text-gray-900",children:"Focal"}),c.length>1&&a.jsx(f,{repos:c,selectedRepo:l,localMode:s.localMode})]}),a.jsx("div",{className:"ml-auto",children:a.jsx(d,{gitStatus:s,selectedRepo:l})})]}),a.jsx("main",{className:"flex-1 overflow-auto",children:e})]}),null!==h&&a.jsx(b.r,{type:h,repoName:l,onClose:k})]})}},111:(e,t,s)=>{"use strict";s.d(t,{r:()=>i});var a=s(326),r=s(7577),n=s(5047),c=s(8176),l=s(8033);function i({type:e,repoName:t,onClose:s}){let i=(0,n.useRouter)(),[o,d]=(0,r.useState)(""),[f,u]=(0,r.useTransition)(),m=(0,r.useCallback)(()=>s(),[s]);return(0,c.a)((0,r.useMemo)(()=>[{key:"Escape",global:!0,handler:m}],[m])),(0,a.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[a.jsx("div",{className:"absolute inset-0 bg-black/40",onClick:s}),(0,a.jsxs)("div",{className:"relative rounded-lg border border-gray-200 bg-white shadow-xl w-full max-w-md mx-4 p-5",children:[a.jsx("h2",{className:"text-sm font-semibold text-gray-900 mb-4",children:"task"===e?"New task":"New document"}),(0,a.jsxs)("form",{onSubmit:function(a){a.preventDefault(),o.trim()&&!f&&u(async()=>{if("task"===e){let{taskId:e}=await (0,l.vr)({title:o.trim(),repoName:t});i.push(`/task/${e}`)}else{let{slug:e}=await (0,l.do)({title:o.trim(),repoName:t});i.push(`/docs/${e}`)}s()})},children:[a.jsx("input",{type:"text",value:o,onChange:e=>d(e.target.value),placeholder:"Title",autoFocus:!0,disabled:f,className:"w-full rounded-md border border-gray-300 px-3 py-2 text-sm text-gray-900 placeholder-gray-400 focus:border-gray-500 focus:outline-none focus:ring-1 focus:ring-gray-500 disabled:opacity-50"}),(0,a.jsxs)("div",{className:"mt-4 flex justify-end gap-2",children:[a.jsx("button",{type:"button",onClick:s,disabled:f,className:"rounded-md px-3 py-1.5 text-sm text-gray-600 hover:bg-gray-100 disabled:opacity-50",children:"Cancel"}),a.jsx("button",{type:"submit",disabled:!o.trim()||f,className:"rounded-md bg-blue-600 px-4 py-2 text-sm font-medium text-white shadow-sm hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors disabled:opacity-50",children:f?"Creating…":"Create"})]})]})]})]})}},744:(e,t,s)=>{"use strict";s.d(t,{ShortcutHelp:()=>l});var a=s(326),r=s(7577),n=s(8176);let c=[{title:"Board",shortcuts:[{keys:["N"],label:"New task"},{keys:["J","↓"],label:"Move down"},{keys:["K","↑"],label:"Move up"},{keys:["H","←"],label:"Move left"},{keys:["L","→"],label:"Move right"},{keys:["↵"],label:"Open task"},{keys:["Esc"],label:"Clear selection"}]},{title:"Task Edit",shortcuts:[{keys:["⌘S"],label:"Save task"},{keys:["Esc"],label:"Back to board"}]},{title:"Docs",shortcuts:[{keys:["N"],label:"New document"},{keys:["E"],label:"Edit document"},{keys:["⌘S"],label:"Save document"},{keys:["Esc"],label:"Cancel editing"}]},{title:"Global",shortcuts:[{keys:["["],label:"Toggle sidebar"},{keys:["Ctrl+↵"],label:"Commit changes"},{keys:["?"],label:"Toggle this help"}]}];function l(){let[e,t]=(0,r.useState)(!1),s=(0,r.useCallback)(()=>t(e=>!e),[]);return((0,n.a)((0,r.useMemo)(()=>[{key:"?",shift:!0,handler:s}],[s])),e)?(0,a.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[a.jsx("div",{className:"absolute inset-0 bg-black/40",onClick:()=>t(!1)}),(0,a.jsxs)("div",{className:"relative rounded-lg border border-gray-200 bg-white shadow-xl w-full max-w-md mx-4 p-5",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h2",{className:"text-sm font-semibold text-gray-900",children:"Keyboard shortcuts"}),a.jsx("button",{onClick:()=>t(!1),className:"text-gray-400 hover:text-gray-600 text-sm",children:"Esc"})]}),a.jsx("div",{className:"space-y-4",children:c.map(e=>(0,a.jsxs)("div",{children:[a.jsx("h3",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide mb-2",children:e.title}),a.jsx("div",{className:"space-y-1.5",children:e.shortcuts.map(e=>(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-sm text-gray-700",children:e.label}),a.jsx("div",{className:"flex items-center gap-1",children:e.keys.map(e=>a.jsx("kbd",{className:"inline-flex min-w-[22px] items-center justify-center rounded border border-gray-300 bg-gray-50 px-1.5 py-0.5 font-mono text-xs text-gray-600",children:e},e))})]},e.label))})]},e.title))})]})]}):null}},8176:(e,t,s)=>{"use strict";function a(e){}s.d(t,{a:()=>a}),s(7577)},9053:(e,t,s)=>{"use strict";s.r(t),s.d(t,{commitChanges:()=>C,createDoc:()=>S,createTask:()=>$,getGitStatus:()=>k,getRepoList:()=>g,getSelectedRepo:()=>p,getUncommittedFiles:()=>N,saveDoc:()=>j,saveTask:()=>y,setSelectedRepo:()=>x});var a=s(4330);s(166);var r=s(7561),n=s.n(r),c=s(7718),l=s(9411),i=s.n(l),o=s(3673),d=s.n(o),f=s(7708),u=s(1615),m=s(8154),b=s(618);let h="focal-repo";async function x(e){(await (0,u.cookies)()).set(h,e,{path:"/",maxAge:31536e3}),(0,f.revalidatePath)("/")}async function p(){let e=await (0,u.cookies)();return e.get(h)?.value}async function g(){return(0,m.HA)().map(e=>e.name)}async function y(e){let{filePath:t,title:s,status:a,priority:r,assignee:c,body:l}=e,o=i().resolve(t),u=(0,m.gk)()?(0,m.HB)():m.n7;if(!o.startsWith(u+i().sep)||!o.includes(`${i().sep}.focal${i().sep}tasks${i().sep}`))throw Error("Invalid file path");let b=n().readFileSync(o,"utf-8"),{content:h}=d()(b),x={title:s,status:a};r&&(x.priority=r),c&&(x.assignee=c);let p=d().stringify(void 0!==l?l:h,x);n().writeFileSync(o,p,"utf-8"),(0,f.revalidatePath)("/"),(0,f.revalidatePath)("/task")}async function j(e){let{filePath:t,content:s}=e,a=i().resolve(t),r=(0,m.gk)()?(0,m.HB)():m.n7;if(!a.startsWith(r+i().sep)||!a.includes(`${i().sep}.focal${i().sep}docs${i().sep}`))throw Error("Invalid file path");n().writeFileSync(a,s,"utf-8"),(0,f.revalidatePath)("/"),(0,f.revalidatePath)("/docs")}function v(e){let t=e.indexOf(".focal/");return -1===t?null:e.slice(t)}function w(e,t,s){return e?e.split("\n").filter(e=>{let t=v(e);return null!==t&&(t.startsWith(".focal/docs/")||t.startsWith(".focal/tasks/"))}).map(e=>{let a=v(e),{title:r,kind:c}=function(e,t){let s=e.replace(/^\.focal\//,"").startsWith("tasks/"),a=i().join(t,e);if(s&&n().existsSync(a))try{let e=n().readFileSync(a,"utf-8"),{data:t}=d()(e);if(t.title)return{title:t.title,kind:"task"}}catch{}return{title:i().basename(e).replace(/\.\w+$/,"").replace(/-/g," ").replace(/\b\w/g,e=>e.toUpperCase()),kind:s?"task":"doc"}}(a,s);return{path:`${t}/${a}`,title:r,kind:c,status:e.startsWith("??")?"new":"modified"}}):[]}async function k(e){if((0,m.gk)()){let e=(0,m.HB)(),t=i().basename(e);try{let s=(0,c.execSync)("git status --porcelain .focal/",{cwd:e,encoding:"utf-8"}).trim();return{localMode:!0,files:w(s,t,e)}}catch{return{localMode:!0,files:[]}}}let t=(0,m.Nj)(),s=[];for(let a of t){if(e&&a!==e)continue;let t=(0,m.Po)(a),r=i().join(t,".focal");if(n().existsSync(r))try{let e=(0,c.execSync)("git status --porcelain .focal/",{cwd:t,encoding:"utf-8"}).trim();s.push(...w(e,a,t))}catch{}}return{localMode:!1,files:s}}async function N(){if((0,m.gk)()){let e=(0,m.HB)(),t=i().basename(e);try{let s=(0,c.execSync)("git status --porcelain .focal/",{cwd:e,encoding:"utf-8"}).trim();if(!s)return[];return s.split("\n").map(e=>`${t}/${e.slice(3)}`)}catch{return[]}}let e=(0,m.Nj)(),t=[];for(let s of e){let e=(0,m.Po)(s),a=i().join(e,".focal");if(n().existsSync(a))try{let a=(0,c.execSync)("git status --porcelain .focal/",{cwd:e,encoding:"utf-8"}).trim();if(a)for(let e of a.split("\n")){let a=e.slice(3);t.push(`${s}/${a}`)}}catch{}}return t}async function $({title:e,repoName:t}){let s,a;let r=e.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/^-+|-+$/g,"");if((0,m.gk)())s=(0,m.HB)(),a=i().basename(s);else{if(!t)throw Error("repoName required in multi-repo mode");s=(0,m.Po)(t),a=t}let c=i().join(s,".focal","tasks");n().mkdirSync(c,{recursive:!0});let l=r,o=2;for(;n().existsSync(i().join(c,`${l}.mdx`));)l=`${r}-${o}`,o++;let u=i().join(c,`${l}.mdx`),b=i().resolve(u),h=(0,m.gk)()?(0,m.HB)():m.n7;if(!b.startsWith(h+i().sep)||!b.includes(`${i().sep}.focal${i().sep}tasks${i().sep}`))throw Error("Invalid file path");let x=d().stringify("",{title:e,status:"todo"});return n().writeFileSync(b,x,"utf-8"),(0,f.revalidatePath)("/"),{taskId:`${a}/${l}`}}async function S({title:e,repoName:t}){let s,a;let r=e.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/^-+|-+$/g,"");if((0,m.gk)())s=(0,m.HB)(),a=i().basename(s);else{if(!t)throw Error("repoName required in multi-repo mode");s=(0,m.Po)(t),a=t}let c=i().join(s,".focal","docs");n().mkdirSync(c,{recursive:!0});let l=r,o=2;for(;n().existsSync(i().join(c,`${l}.md`));)l=`${r}-${o}`,o++;let d=i().join(c,`${l}.md`),u=i().resolve(d),b=(0,m.gk)()?(0,m.HB)():m.n7;if(!u.startsWith(b+i().sep)||!u.includes(`${i().sep}.focal${i().sep}docs${i().sep}`))throw Error("Invalid file path");return n().writeFileSync(u,"","utf-8"),(0,f.revalidatePath)("/docs"),{slug:`${a}/${l}`}}async function C(e){if((0,m.gk)()){let e=(0,m.HB)();try{if(!(0,c.execSync)("git status --porcelain .focal/",{cwd:e,encoding:"utf-8"}).trim())return{message:"No changes to commit"};(0,c.execSync)("git add .focal/",{cwd:e}),(0,c.execSync)('git commit -m "Update focal content"',{cwd:e});try{(0,m.wf)(e)}catch{}return(0,f.revalidatePath)("/"),{message:"Committed changes"}}catch{return(0,f.revalidatePath)("/"),{message:"Failed to commit changes"}}}let t=(0,m.Nj)(),s=0,a=[];for(let r of t){if(e&&r!==e)continue;let t=(0,m.Po)(r),l=i().join(t,".focal");if(n().existsSync(l))try{if(!(0,c.execSync)("git status --porcelain .focal/",{cwd:t,encoding:"utf-8"}).trim())continue;(0,c.execSync)("git add .focal/",{cwd:t}),(0,c.execSync)('git commit -m "Update focal content"',{cwd:t});try{(0,m.wf)(t)}catch{a.push(`Push failed for ${r}`)}s++}catch{}}return((0,f.revalidatePath)("/"),a.length>0)?{message:a.join("; ")}:0===s?{message:"No changes to commit"}:{message:`Committed and pushed in ${s} ${1===s?"repository":"repositories"}`}}(0,b.h)([x,p,g,y,j,k,N,$,S,C]),(0,a.j)("29d9cd11d097fcb6690a26ef774aeeee260b389b",x),(0,a.j)("bfa1de4d25904e288eea8780fb8c48c13f8304d2",p),(0,a.j)("ac8031647eec6a4700a6a90d39c2af1c1d5bd267",g),(0,a.j)("0b32d0e7a9e913867bfb2724e5c71bc874ca9624",y),(0,a.j)("d36e843f1a3e9ed7e591d8cb5f8779c3f4ad0876",j),(0,a.j)("48e24bf6b7790941829c1b47555db59c45439f76",k),(0,a.j)("5896e2c5181e1accf5bdf86f55c5717bc2bfa048",N),(0,a.j)("5171b9bc6fa8d6fb730de54219624f90f34cbafd",$),(0,a.j)("f53de7a8283b631e23b5e166f5d38eeac215e2cd",S),(0,a.j)("4810e0847edab22d875d1f15f89918103c558ebd",C)},9097:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>f,dynamic:()=>d,metadata:()=>o});var a=s(9510),r=s(8570);let n=(0,r.createProxy)(String.raw`/Users/antoine/src/focal/src/components/AppShell.tsx#AppShell`),c=(0,r.createProxy)(String.raw`/Users/antoine/src/focal/src/components/ShortcutHelp.tsx#ShortcutHelp`);var l=s(8627),i=s(9053);s(5023);let o={title:"Focal",description:"File-centric task and documentation manager for software projects"},d="force-dynamic";async function f({children:e}){let t=await (0,i.getRepoList)(),s=await (0,i.getSelectedRepo)(),r=s&&t.includes(s)?s:t[0],o=(0,l.os)(r),d=await (0,i.getGitStatus)(r);return a.jsx("html",{lang:"en",children:(0,a.jsxs)("body",{children:[a.jsx(n,{docTree:o,gitStatus:d,repos:t,selectedRepo:r,children:e}),a.jsx(c,{})]})})}},8627:(e,t,s)=>{"use strict";s.d(t,{$O:()=>d,Kp:()=>u,P:()=>f,os:()=>o});var a=s(7561),r=s.n(a),n=s(9411),c=s.n(n),l=s(8154);function i(e){return e.replace(/-/g," ").replace(/\b\w/g,e=>e.toUpperCase())}function o(e){let t=(0,l.HA)(),s=[];for(let a of t){if(e&&a.name!==e)continue;let t=c().join(a.path,".focal","docs");if(!r().existsSync(t))continue;let n=function e(t,s,a=""){let n;let l=[];try{n=r().readdirSync(t,{withFileTypes:!0})}catch{return l}for(let r of(n.sort((e,t)=>e.name.startsWith("index.")?-1:t.name.startsWith("index.")?1:e.name.localeCompare(t.name)),n)){if(r.name.startsWith("."))continue;let n=c().join(t,r.name);if(r.isDirectory()){let t=a?`${a}/${r.name}`:r.name,c=e(n,s,t);c.length>0&&l.push({slug:`${s}/${t}`,title:i(r.name),filePath:n,repository:s,children:c})}else{var o;if((o=r.name).endsWith(".md")||o.endsWith(".mdx")){let e=r.name.replace(/\.(md|mdx)$/,""),t=a?`${a}/${e}`:e;l.push({slug:`${s}/${t}`,title:i(e),filePath:n,repository:s})}}}return l}(t,a.name);s.push(...n)}return s}function d(e){let t=[];for(let s of e)s.children?t.push(...d(s.children)):t.push(s);return t}function f(e){return d(o()).find(t=>t.slug===e)??null}function u(e){return r().readFileSync(e,"utf-8")}},8154:(e,t,s)=>{"use strict";s.d(t,{HA:()=>x,HB:()=>u,Nj:()=>m,Po:()=>b,gk:()=>f,n7:()=>o,wf:()=>p});var a=s(7561),r=s.n(a),n=s(9411),c=s.n(n),l=s(7718);let i=/^[a-zA-Z0-9_.-]+\/[a-zA-Z0-9_.-]+$/,o="/tmp/focal/repos",d=new Set;function f(){let e=process.env.GITHUB_REPOS;return!e||""===e.trim()}function u(e=process.cwd()){let t=c().resolve(e);for(;;){if(r().existsSync(c().join(t,".git")))return t;let e=c().dirname(t);if(e===t)throw Error("Not inside a git repository");t=e}}function m(){let e=process.env.GITHUB_REPOS;if(!e)return[];let t=e.split(",").map(e=>e.trim()).filter(Boolean),s=[];for(let e of t)i.test(e)?s.push(e):console.warn(`[focal] Ignoring invalid repo slug: ${e}`);return s}function b(e){let[t,s]=e.split("/");return c().join(o,t,s)}function h(e){let t=b(e),s=c().dirname(t);r().mkdirSync(s,{recursive:!0}),(0,l.execSync)(`git clone --depth 1 ${function(e){let t=process.env.GITHUB_TOKEN;return t?`https://x-access-token:${t}@github.com/${e}.git`:`https://github.com/${e}.git`}(e)} ${t}`,{stdio:"pipe",timeout:6e4})}function x(){if(f())try{return[function(){let e=u();return{name:c().basename(e),path:e}}()]}catch{throw Error('No GITHUB_REPOS configured and not inside a git repository. Set the GITHUB_REPOS environment variable (e.g. "owner/repo") to use remote mode.')}let e=m(),t=[];for(let s of e)try{(function(e){if(d.has(e))return;let t=b(e);r().existsSync(c().join(t,".git"))?function(e){let t=b(e);try{(0,l.execSync)("git fetch origin",{cwd:t,stdio:"pipe",timeout:3e4});let e=(0,l.execSync)("git rev-parse --abbrev-ref HEAD",{cwd:t,stdio:"pipe"}).toString().trim();(0,l.execSync)(`git reset --hard origin/${e}`,{cwd:t,stdio:"pipe"})}catch(a){let s=a instanceof Error?a.message:String(a);s.includes("not a git repository")?(console.warn(`[focal] ${e} is corrupted, re-cloning`),r().rmSync(t,{recursive:!0,force:!0}),h(e)):console.warn(`[focal] git pull failed for ${e}: ${s}`)}}(e):h(e),d.add(e)})(s),t.push({name:s,path:b(s)})}catch(a){console.warn(`[focal] Failed to sync ${s}: ${a instanceof Error?a.message:a}`);let e=b(s);r().existsSync(c().join(e,".git"))&&t.push({name:s,path:e})}return t}function p(e){(0,l.execSync)("git push",{cwd:e,stdio:"pipe",timeout:3e4})}},5023:()=>{}};