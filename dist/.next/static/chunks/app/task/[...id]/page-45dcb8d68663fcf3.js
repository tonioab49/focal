(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[164],{8817:function(e,t,s){Promise.resolve().then(s.bind(s,3190))},3190:function(e,t,s){"use strict";s.d(t,{TaskEditForm:function(){return y}});var a=s(7437),l=s(2265),r=s(9376),o=s(7648),n=s(6938),d=s(6210),i=s(3947),c=s(9796),u=s(2475),m=s(9837),x=s(5488),b=s(5064),g=s(1683),h=s(9194);let p=[{value:"todo",label:"To Do"},{value:"in-progress",label:"In Progress"},{value:"done",label:"Done"}],f=[{value:"",label:"None"},{value:"low",label:"Low"},{value:"medium",label:"Medium"},{value:"high",label:"High"},{value:"urgent",label:"Urgent"}];function y(e){var t,s;let{task:y}=e,v=(0,r.useRouter)(),[j,N]=(0,l.useTransition)(),[k,w]=(0,l.useState)(y.title),[C,S]=(0,l.useState)(y.status),[P,_]=(0,l.useState)(null!==(t=y.priority)&&void 0!==t?t:""),[E,F]=(0,l.useState)(null!==(s=y.assignee)&&void 0!==s?s:""),[M,T]=(0,l.useState)(null),[L,D]=(0,l.useState)(!1),{provider:O,ydocRef:A,connectedUsers:B,user:H,broadcastSave:R}=(0,x.C)("task:".concat(y.filePath),{onSaveBroadcast:()=>D(!1)}),U=(0,m.n)(),Z=(0,l.useMemo)(()=>O&&A.current?[...(0,u.y)({collaboration:!0}),d.ZP.configure({document:A.current}),i.Z.configure({provider:O,user:H,render:e=>{let t=document.createElement("span");t.classList.add("collaboration-carets__caret"),t.style.borderColor=e.color;let s=document.createElement("div");return s.classList.add("collaboration-carets__label"),s.style.backgroundColor=e.color,s.textContent=e.id===H.id?"Me":e.name,t.append(s),t}})]:null,[O,H,A]),I=(0,n.jE)({extensions:null!=Z?Z:(0,u.y)(),editable:!0,immediatelyRender:!1,editorProps:{attributes:{class:"prose prose-sm max-w-none focus:outline-none min-h-[200px]"}},onUpdate:e=>{let{transaction:t}=e;t.getMeta("y-sync$")||D(!0)}},[Z]),$=(0,l.useCallback)(()=>{T(null),N(async()=>{try{let e;if(I&&L){let t=I.getHTML();e=c.O.turndown(t)}await (0,b.F9)({filePath:y.filePath,title:k,status:C,priority:P,assignee:E,body:e}),D(!1),R(),v.push("/")}catch(e){T("Failed to save task")}})},[y.filePath,k,C,P,E,I,L,v,R]),q=(0,l.useCallback)(()=>{v.push("/")},[v]);return(0,g.a)((0,l.useMemo)(()=>[{key:"s",meta:!0,handler:$,global:!0},{key:"Escape",handler:q,global:!0}],[$,q])),(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"mb-6 flex items-center gap-3",children:[(0,a.jsx)(o.default,{href:"/",className:"text-sm text-gray-500 hover:text-gray-900 transition-colors",children:"← Back"}),B.length>0&&(0,a.jsx)("div",{className:"flex items-center gap-1.5 ml-auto",children:(0,a.jsx)("div",{className:"flex -space-x-1.5",children:B.slice(0,5).map((e,t)=>(0,a.jsx)("div",{className:"flex h-6 w-6 items-center justify-center rounded-full border-2 border-white text-[10px] font-semibold text-white",style:{backgroundColor:e.color},title:e.displayName,children:e.displayName.charAt(0)},t))})}),(0,a.jsxs)("span",{className:"flex items-center gap-2 text-xs text-gray-400 ".concat(0===B.length?"ml-auto":""),children:[(0,a.jsx)("kbd",{className:"rounded border border-gray-300 bg-gray-100 px-1.5 py-0.5 font-mono text-[10px] text-gray-500",children:"Esc"}),(0,a.jsx)("span",{children:"back"}),(0,a.jsx)("kbd",{className:"ml-2 rounded border border-gray-300 bg-gray-100 px-1.5 py-0.5 font-mono text-[10px] text-gray-500",children:"⌘S"}),(0,a.jsx)("span",{children:"save"})]})]}),(0,a.jsxs)("div",{className:"space-y-5",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"title",className:"block text-sm font-medium text-gray-700 mb-1",children:"Title"}),(0,a.jsx)("input",{id:"title",type:"text",value:k,onChange:e=>w(e.target.value),className:"w-full rounded-md border border-gray-300 px-3 py-2 text-sm text-gray-900 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-1 focus:ring-blue-500"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"status",className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),(0,a.jsx)("select",{id:"status",value:C,onChange:e=>S(e.target.value),className:"w-full rounded-md border border-gray-300 px-3 py-2 text-sm text-gray-900 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-1 focus:ring-blue-500",children:p.map(e=>(0,a.jsx)("option",{value:e.value,children:e.label},e.value))})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"priority",className:"block text-sm font-medium text-gray-700 mb-1",children:"Priority"}),(0,a.jsx)("select",{id:"priority",value:P,onChange:e=>_(e.target.value),className:"w-full rounded-md border border-gray-300 px-3 py-2 text-sm text-gray-900 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-1 focus:ring-blue-500",children:f.map(e=>(0,a.jsx)("option",{value:e.value,children:e.label},e.value))})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"assignee",className:"block text-sm font-medium text-gray-700 mb-1",children:"Assignee"}),(0,a.jsx)("input",{id:"assignee",type:"text",value:E,onChange:e=>F(e.target.value),placeholder:"e.g. alice@example.com",className:"w-full rounded-md border border-gray-300 px-3 py-2 text-sm text-gray-900 shadow-sm placeholder:text-gray-400 focus:border-blue-500 focus:outline-none focus:ring-1 focus:ring-blue-500"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),I&&(0,a.jsx)(h.g,{editor:I,className:"mb-0 rounded-t-md border border-b-0 border-gray-300 bg-gray-50 px-2 py-1.5"}),(0,a.jsx)("div",{className:"rounded-b-md border border-gray-300 px-3 py-2",onClickCapture:U,children:(0,a.jsx)(n.kg,{editor:I})})]}),(0,a.jsxs)("div",{className:"rounded-md bg-gray-50 border border-gray-200 px-3 py-2",children:[(0,a.jsx)("span",{className:"text-xs font-medium text-gray-500",children:"File"}),(0,a.jsx)("p",{className:"text-sm text-gray-700 font-mono mt-0.5 break-all",children:y.filePath})]}),M&&(0,a.jsx)("p",{className:"text-sm text-red-600",children:M}),(0,a.jsxs)("div",{className:"flex items-center gap-3 pt-2",children:[(0,a.jsx)("button",{onClick:$,disabled:j,className:"rounded-md bg-blue-600 px-4 py-2 text-sm font-medium text-white shadow-sm hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors disabled:opacity-50",children:j?"Saving...":"Save"}),(0,a.jsx)(o.default,{href:"/",className:"rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 shadow-sm hover:bg-gray-50 transition-colors",children:"Cancel"})]})]})]})}}},function(e){e.O(0,[900,572,902,219,611,757,971,117,744],function(){return e(e.s=8817)}),_N_E=e.O()}]);