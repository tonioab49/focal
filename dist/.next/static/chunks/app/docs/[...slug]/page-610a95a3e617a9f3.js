(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[687],{4349:function(e,t,r){Promise.resolve().then(r.bind(r,4523))},9376:function(e,t,r){"use strict";var n=r(5475);r.o(n,"usePathname")&&r.d(t,{usePathname:function(){return n.usePathname}}),r.o(n,"useRouter")&&r.d(t,{useRouter:function(){return n.useRouter}})},2119:function(e,t,r){"use strict";Object.defineProperty(t,"$",{enumerable:!0,get:function(){return s}});let n=r(3079);function s(e){let{createServerReference:t}=r(6671);return t(e,n.callServer)}},4523:function(e,t,r){"use strict";r.d(t,{DocEditor:function(){return h}});var n=r(7437),s=r(2265),a=r(9376),o=r(6938),l=r(6210),c=r(3947),i=r(9796),d=r(2475),u=r(9837),m=r(5488),x=r(5064),b=r(1683),f=r(9194);function h(e){let{filePath:t,content:r,title:h,slug:p}=e,y=(0,a.useRouter)(),[g,v]=(0,s.useState)(!1),[j,N]=(0,s.useState)(!1),{provider:k,ydocRef:w,connectedUsers:C,user:_,broadcastSave:S}=(0,m.C)(t,{onSaveBroadcast:()=>N(!1)}),E=(0,u.n)(),P=(0,s.useMemo)(()=>k&&w.current?[...(0,d.y)({collaboration:!0}),l.ZP.configure({document:w.current}),c.Z.configure({provider:k,user:_,render:e=>{let t=document.createElement("span");t.classList.add("collaboration-carets__caret"),t.style.borderColor=e.color;let r=document.createElement("div");return r.classList.add("collaboration-carets__label"),r.style.backgroundColor=e.color,r.textContent=e.id===_.id?"Me":e.name,t.append(r),t}})]:null,[k,_,w]),M=(0,o.jE)({extensions:null!=P?P:(0,d.y)(),editable:!0,immediatelyRender:!1,editorProps:{attributes:{class:"prose prose-sm max-w-none focus:outline-none min-h-[200px]"}},onUpdate:e=>{let{transaction:t}=e;t.getMeta("y-sync$")||N(!0)}},[P]),R=(0,s.useCallback)(async()=>{if(M&&k&&!g&&j){v(!0);try{let e=M.getHTML(),r=i.O.turndown(e);await (0,x.MF)({filePath:t,content:r}),N(!1),S(),y.refresh()}catch(e){console.error("Failed to save:",e)}finally{v(!1)}}},[M,t,g,j,y,k,S]);return(0,b.a)((0,s.useMemo)(()=>[{key:"s",meta:!0,handler:R,global:!0}],[R])),(0,n.jsxs)("div",{className:"mx-auto max-w-[750px]",children:[(0,n.jsxs)("div",{className:"mb-4 flex items-center justify-between",children:[(0,n.jsx)("h1",{className:"text-xl font-semibold text-gray-900",children:h}),(0,n.jsxs)("div",{className:"flex items-center gap-3",children:[C.length>0&&(0,n.jsx)("div",{className:"flex items-center gap-1.5",children:(0,n.jsx)("div",{className:"flex -space-x-1.5",children:C.slice(0,5).map((e,t)=>(0,n.jsx)("div",{className:"flex h-6 w-6 items-center justify-center rounded-full border-2 border-white text-[10px] font-semibold text-white",style:{backgroundColor:e.color},title:e.displayName,children:e.displayName.charAt(0)},t))})}),j&&(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)("span",{className:"text-sm text-gray-500",children:"Unsaved changes"}),(0,n.jsx)("button",{onClick:R,disabled:g,className:"rounded-md bg-blue-600 px-3 py-1.5 text-sm font-medium text-white hover:bg-blue-700 transition-colors disabled:opacity-50",children:g?"Saving...":"Save"})]})]})]}),M&&(0,n.jsx)(f.g,{editor:M,className:"mb-3 border-b border-gray-200 pb-3"}),(0,n.jsx)("div",{onClickCapture:E,children:(0,n.jsx)(o.kg,{editor:M})}),j&&(0,n.jsxs)("p",{className:"mt-2 text-xs text-gray-400",children:[(0,n.jsx)("kbd",{className:"rounded border border-gray-200 bg-gray-100 px-1 py-0.5 font-mono text-[10px]",children:"âŒ˜S"})," to save"]})]})}}},function(e){e.O(0,[900,572,902,611,757,971,117,744],function(){return e(e.s=4349)}),_N_E=e.O()}]);